--[[
    Maveryk Hub - Pet Swarm Simulator
    Versão: Insane Farme Ultra Otimizado
    Desenvolvido por Maveryk1t
    Melhorias: Prioridades, Coroutines, Cache Inteligente, Anti-Flood, Anti-AFK
]]

-- Carregar biblioteca de interface
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Serviços do Roblox
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local VirtualUser = game:GetService("VirtualUser")
local LocalPlayer = Players.LocalPlayer

-- Remotes (comandos do jogo)
local Remotes = ReplicatedStorage and ReplicatedStorage:FindFirstChild("Remotes")
local Functions = Remotes and Remotes:FindFirstChild("Functions")
local Events = Remotes and Remotes:FindFirstChild("Events")

local CombatRemote = Functions and Functions:FindFirstChild("CombatRF")           -- Atacar
local CollectionRemote = Functions and Functions:FindFirstChild("CollectionRF")   -- Coletar comida
local HatchRemote = Events and Events:FindFirstChild("HatchEggEvent")             -- Chocar ovo
local PlantRemote = Events and Events:FindFirstChild("PlantEggEvent")             -- Plantar ovo
local FeedRemote = Events and Events:FindFirstChild("FeedEggEvent")               -- Alimentar ninho
local SacrificeRemote = Functions and Functions:FindFirstChild("SacrificeFunction") -- Sacrificar
local ZonesRF = Functions and Functions:FindFirstChild("ZonesRF")                 -- Carregar zona

-- Variáveis de controle
local active = false                    -- Farm ligado/desligado
local eggsSelected = {}                  -- Ovos selecionados para plantar
local bossEnabled = {}                   -- Bosses ativados
local activeBosses = {}                   -- Bosses vivos atualmente
local jumpConnection = nil                -- Conexão do pulo duplo
local jumpCount = 0                       -- Contador de pulos
local antiAfkConnection = nil              -- Conexão do anti-afk

-- Cache otimizado com tempos dinâmicos
local cache = {
    pets = { value = nil, lastUpdate = 0, ttl = 0.2 },      -- 0.2s
    nests = { value = nil, lastUpdate = 0, ttl = 5 },       -- 5s
    zones = {},                                              -- Carregado uma vez
    enemies = { value = {}, lastUpdate = 0, ttl = 0.5 },     -- Inimigos por zona
}

-- Carregar todas as zonas do Workspace.Zones (dinâmico)
local function loadAllZones()
    local zonesFolder = Workspace:FindFirstChild("Zones")
    if zonesFolder then
        for _, zone in ipairs(zonesFolder:GetChildren()) do
            cache.zones[zone.Name] = zone
        end
    end
end
loadAllZones()

-- Atualizar cache quando novas zonas aparecerem (ex: eventos)
Workspace.Zones.ChildAdded:Connect(function(zone)
    cache.zones[zone.Name] = zone
end)

-- Lista de inimigos (SEM OVOS DE BOSS) - será preenchida dinamicamente também
local enemyList = {}
local enemyEnabled = {}

-- Função para escanear inimigos nas zonas (dinâmico)
local function scanEnemies()
    local newEnemies = {}
    for zoneName, zone in pairs(cache.zones) do
        if zone:FindFirstChild("Enemies") then
            for _, enemy in ipairs(zone.Enemies:GetChildren()) do
                -- Ignorar bosses (serão tratados separadamente)
                if not bossZoneMap[enemy.Name] then
                    table.insert(newEnemies, {
                        name = enemy.Name,
                        zone = zoneName,
                        enemyObj = enemy
                    })
                end
            end
        end
    end
    return newEnemies
end

-- Atualizar lista de inimigos periodicamente
task.spawn(function()
    while true do
        enemyList = scanEnemies()
        -- Inicializar enabled se necessário
        for i, enemy in ipairs(enemyList) do
            if enemyEnabled[i] == nil then
                enemyEnabled[i] = false
            end
        end
        task.wait(10)
    end
end)

-- Mapa de zonas dos bosses
local bossZoneMap = {
    Naga = "Zone2B1",
    ["Lava Monster"] = "Zone5B1",
    ["Tiki Monster"] = "Zone10B1",
    ["The Frozen Ancient"] = "Zone12B1",
    ["The Big 100M"] = "Zone12B3",
    ["The Ethereal Everia"] = "Zone12B2",
    ["Hornet Boss"] = "SummerEventZoneB1",
    ["The Ice Serpent"] = "WinterEventZoneB1",
    ["Great Sphinx"] = "ElementEventZoneB1",
}

-- Lista de bosses fixa (pode ser expandida)
local bossList = {
    "Naga", "Lava Monster", "Tiki Monster",
    "The Frozen Ancient", "The Big 100M", "The Ethereal Everia",
    "Hornet Boss", "The Ice Serpent", "Great Sphinx"
}
for _, name in ipairs(bossList) do bossEnabled[name] = true end

-- Zonas de comida (podem ser dinâmicas)
local foodZones = {
    { name = "Crystal Food", zone = "Zone12.1", enabled = false },
    { name = "Draco Food", zone = "Zone12", enabled = false },
}

-- Configurações do usuário
local config = {
    farmBosses = false,
    farmEnemies = false,
    farmFood = false,
    autoPlant = false,
    autoHatch = false,
    autoNests = false,
    sacrificeQueen = false,
    sacrificeKing = false,
    sacrificeFrozen = false,
    sacrificeWalrus = false,
    sacrificeFennec = false,
    sacrificeMystic = false,
    doubleJump = false,
    antiAfk = false,
    wallspeed = 16,
    plantSpeed = 0.1,
    hatchSpeed = 0.1,
    nestsSpeed = 0.1,
}

-- Lista de ovos (pode ser dinâmica)
local eggData = {
    { name = "Summer Egg", zone = "SummerEvent1" },
    { name = "Winter Egg", zone = "WinterEvent1" },
    { name = "Sphinx Egg", zone = "EleEgg1" },
    { name = "Desert Egg", zone = "6" },
    { name = "Swamp Egg", zone = "4" },
    { name = "Sky Egg", zone = "15" },
    { name = "Cosmos Egg", zone = "10" },
    { name = "Void Egg", zone = "27" },
    { name = "Tiki Egg", zone = "30" },
    { name = "Tiki Island Egg", zone = "11" },
    { name = "Draco Egg", zone = "34" },
    { name = "Crystal Egg", zone = "12.1" },
    { name = "Octopus Egg", zone = "30" },
    { name = "Forest Egg", zone = "1" },
    { name = "Frozen Egg", zone = "3" },
    { name = "Magma Egg", zone = "7" },
    { name = "Atlantis Egg", zone = "8" },
    { name = "Aqua Egg", zone = "9" },
    { name = "Egg Of Oblivion", zone = "12" },
    { name = "Mythical Egg", zone = "13" },
    { name = "Legendary Egg", zone = "14" },
}

--[[
    FUNÇÕES AUXILIARES OTIMIZADAS
]]

-- Pegar zona do cache (já carregada)
local function getZone(name)
    return cache.zones[name]
end

-- Pegar lista de pets com cache TTL dinâmico
local function getPets()
    local now = os.clock()
    if not cache.pets.value or now - cache.pets.lastUpdate > cache.pets.ttl then
        if LocalPlayer.Character then
            local pets = LocalPlayer.Character:FindFirstChild("Pets")
            cache.pets.value = pets and pets:GetChildren() or {}
        else
            cache.pets.value = {}
        end
        cache.pets.lastUpdate = now
    end
    return cache.pets.value
end

-- Atualizar cache quando personagem mudar
LocalPlayer.CharacterAdded:Connect(function()
    cache.pets.lastUpdate = 0
end)

-- Pegar ninhos com cache TTL
local function getNests()
    local now = os.clock()
    if not cache.nests.value or now - cache.nests.lastUpdate > cache.nests.ttl then
        cache.nests.value = Workspace:FindFirstChild("Nests")
        cache.nests.lastUpdate = now
    end
    return cache.nests.value
end

-- Pegar inimigos de uma zona com cache curto
local function getEnemiesInZone(zoneName)
    local now = os.clock()
    if not cache.enemies.value[zoneName] or now - cache.enemies.lastUpdate > cache.enemies.ttl then
        local zone = getZone(zoneName)
        local enemies = {}
        if zone and zone:FindFirstChild("Enemies") then
            for _, enemy in ipairs(zone.Enemies:GetChildren()) do
                table.insert(enemies, enemy)
            end
        end
        cache.enemies.value[zoneName] = enemies
        cache.enemies.lastUpdate = now
    end
    return cache.enemies.value[zoneName]
end

-- Atacar com rate limiting (evita flood)
local lastAttack = 0
local ATTACK_COOLDOWN = 0.05 -- 50ms entre ataques

local function attackEnemy(enemy)
    local now = os.clock()
    if now - lastAttack < ATTACK_COOLDOWN then return end
    lastAttack = now
    
    local pets = getPets()
    if #pets == 0 then return end
    -- Usa o primeiro pet (ou poderia alternar)
    pcall(CombatRemote.InvokeServer, CombatRemote, "AttackEnemy", enemy, pets[1])
end

-- Coletar comida com rate limiting
local lastCollect = 0
local COLLECT_COOLDOWN = 0.1

local function collectFood(foodSpawn)
    local now = os.clock()
    if now - lastCollect < COLLECT_COOLDOWN then return end
    lastCollect = now
    
    local pets = getPets()
    if #pets == 0 then return end
    pcall(CollectionRemote.InvokeServer, CollectionRemote, "CollectFood", foodSpawn, pets[1])
end

-- Plantar ovos (já agrupado em 9)
local function plantEggs(zone)
    for _ = 1, 9 do
        pcall(PlantRemote.FireServer, PlantRemote, zone)
    end
end

-- Chocar ovo
local function hatchEgg()
    pcall(HatchRemote.FireServer, HatchRemote)
end

-- Alimentar ninho
local function feedNest(nest)
    pcall(FeedRemote.FireServer, FeedRemote, nest)
end

-- Sacrificar
local function sacrificePet(petName)
    local success = pcall(function()
        SacrificeRemote:InvokeServer("SacrificeWell", petName)
    end)
    if success then
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Sacrifice",
            Text = petName .. " sacrificed!",
            Duration = 2
        })
    end
    return success
end

-- Teleporte para zona (opcional)
local function teleportToZone(zoneName)
    local zone = getZone(zoneName)
    if zone and LocalPlayer.Character then
        local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid:MoveTo(zone.Position)
        end
    end
end

--[[
    SISTEMA DE PRIORIDADES E WORKERS DEDICADOS
]]

-- Fila de alvos (prioridade: bosses > inimigos > comida)
local targetQueue = {
    bosses = {},    -- Lista de objetos boss
    enemies = {},   -- Lista de objetos inimigo
    food = {},      -- Lista de {zone, foodSpawn}
}

-- Atualizar fila de bosses (chamado frequentemente)
local function updateBossQueue()
    if not config.farmBosses then
        targetQueue.bosses = {}
        return
    end
    local newBosses = {}
    for _, name in ipairs(bossList) do
        if bossEnabled[name] then
            local zone = getZone(bossZoneMap[name])
            if zone and zone:FindFirstChild("Enemies") then
                local enemy = zone.Enemies:FindFirstChild(name)
                if enemy then
                    table.insert(newBosses, enemy)
                end
            end
        end
    end
    targetQueue.bosses = newBosses
end

-- Atualizar fila de inimigos
local function updateEnemyQueue()
    if not config.farmEnemies then
        targetQueue.enemies = {}
        return
    end
    local newEnemies = {}
    for idx, enemy in ipairs(enemyList) do
        if enemyEnabled[idx] then
            local zone = getZone(enemy.zone)
            if zone and zone:FindFirstChild("Enemies") then
                local enemyObj = zone.Enemies:FindFirstChild(enemy.name)
                if enemyObj then
                    table.insert(newEnemies, enemyObj)
                end
            end
        end
    end
    targetQueue.enemies = newEnemies
end

-- Atualizar fila de comida
local function updateFoodQueue()
    if not config.farmFood then
        targetQueue.food = {}
        return
    end
    local newFood = {}
    for _, foodZone in ipairs(foodZones) do
        if foodZone.enabled then
            local zone = getZone(foodZone.zone)
            if zone and zone:FindFirstChild("FoodSpawns") then
                for _, spawn in ipairs(zone.FoodSpawns:GetChildren()) do
                    table.insert(newFood, {zone = foodZone.zone, spawn = spawn})
                end
            end
        end
    end
    targetQueue.food = newFood
end

-- Workers dedicados para cada tipo (rodam em coroutines separadas)
-- Prioridade: bosses sempre atacados primeiro, depois inimigos, depois comida

-- Worker de bosses (prioridade máxima)
task.spawn(function()
    while true do
        if active and config.farmBosses then
            for _, boss in ipairs(targetQueue.bosses) do
                if boss and boss.Parent then
                    attackEnemy(boss)
                end
            end
        end
        task.wait(0.1) -- Verifica a cada 0.1s
    end
end)

-- Worker de inimigos
task.spawn(function()
    while true do
        if active and config.farmEnemies and #targetQueue.bosses == 0 then
            for _, enemy in ipairs(targetQueue.enemies) do
                if enemy and enemy.Parent then
                    attackEnemy(enemy)
                end
            end
        end
        task.wait(0.15)
    end
end)

-- Worker de comida
task.spawn(function()
    while true do
        if active and config.farmFood and #targetQueue.bosses == 0 and #targetQueue.enemies == 0 then
            for _, food in ipairs(targetQueue.food) do
                if food.spawn and food.spawn.Parent then
                    collectFood(food.spawn)
                end
            end
        end
        task.wait(0.2)
    end
end)

-- Workers para plantio, hatch, ninhos (cada um independente)
task.spawn(function()
    while true do
        if active and config.autoPlant and #eggsSelected > 0 then
            for _, zone in ipairs(eggsSelected) do
                plantEggs(zone)
            end
        end
        task.wait(config.plantSpeed)
    end
end)

task.spawn(function()
    while true do
        if active and config.autoHatch then
            hatchEgg()
        end
        task.wait(config.hatchSpeed)
    end
end)

task.spawn(function()
    while true do
        if active and config.autoNests then
            local nests = getNests()
            if nests then
                for _, nest in ipairs(nests:GetChildren()) do
                    feedNest(nest)
                end
            end
        end
        task.wait(config.nestsSpeed)
    end
end)

--[[
    SISTEMA DE SACRIFÍCIO EM LOOP
]]
local sacrificeActive = {
    queen = false, king = false, frozen = false,
    walrus = false, fennec = false, mystic = false
}
local sacrificeThreads = {}

local function toggleSacrifice(petName, enable)
    local key = petName:lower():gsub(" ", "")
    if enable then
        if sacrificeThreads[key] then
            task.cancel(sacrificeThreads[key])
        end
        sacrificeThreads[key] = task.spawn(function()
            -- Carrega zonas necessárias uma vez
            pcall(ZonesRF.InvokeServer, ZonesRF, "RequestZoneMap", "SummerEventZone")
            pcall(ZonesRF.InvokeServer, ZonesRF, "RequestZoneMap", "ElementEventZone1")
            task.wait(1)
            while active and sacrificeActive[key] do
                sacrificePet(petName)
                task.wait(5)
            end
        end)
    else
        if sacrificeThreads[key] then
            task.cancel(sacrificeThreads[key])
            sacrificeThreads[key] = nil
        end
    end
end

--[[
    DETECÇÃO DE BOSSES EM TEMPO REAL (loop rápido)
]]
task.spawn(function()
    while true do
        updateBossQueue()
        task.wait(0.5) -- A cada 0.5s
    end
end)

--[[
    ANTI-AFK
]]
local function startAntiAfk()
    if antiAfkConnection then return end
    antiAfkConnection = RunService.Heartbeat:Connect(function()
        if active and config.antiAfk then
            -- Simula movimento leve
            LocalPlayer.Character.Humanoid:Move(Vector3.new(0,0,0), true)
            VirtualUser:CaptureController()
            VirtualUser:ClickButton2(Vector2.new())
        end
    end)
end

local function stopAntiAfk()
    if antiAfkConnection then
        antiAfkConnection:Disconnect()
        antiAfkConnection = nil
    end
end

--[[
    CONTROLE DO FARM
]]
local function start()
    if active then return end
    active = true
    updateBossQueue()
    updateEnemyQueue()
    updateFoodQueue()
    if config.antiAfk then startAntiAfk() end
    
    -- Inicia threads de sacrifício se necessário
    for pet, enabled in pairs(sacrificeActive) do
        if enabled then
            toggleSacrifice(pet, true)
        end
    end
end

local function stop()
    active = false
    for _, thread in pairs(sacrificeThreads) do
        task.cancel(thread)
    end
    sacrificeThreads = {}
    stopAntiAfk()
end

--[[
    INTERFACE GRÁFICA
]]
local win = Rayfield:CreateWindow({
    Name = "Maveryk Hub",
    LoadingTitle = "Pet Swarm Sim",
    LoadingSubtitle = "Insane farme ultra",
    ConfigurationSaving = { Enabled = true, FolderName = "MaverykHub", FileName = "Config" },
    Theme = "Dark"
})

-- ABA PRINCIPAL
local mainTab = win:CreateTab("Main")
mainTab:CreateSection("Control")
mainTab:CreateButton({ Name = "Start Farming", Callback = start })
mainTab:CreateButton({ Name = "Stop Farming", Callback = stop })

mainTab:CreateSection("Status")
local statusLabel = mainTab:CreateLabel("Status: Stopped")
local bossStatus = mainTab:CreateLabel("Bosses: OFF")
local enemyStatus = mainTab:CreateLabel("Enemies: OFF")
local foodStatus = mainTab:CreateLabel("Food: OFF")
local eggStatus = mainTab:CreateLabel("Eggs: OFF")
local sacrificeStatus = mainTab:CreateLabel("Sacrifice: OFF")

task.spawn(function()
    while true do
        task.wait(0.5)
        if active then
            statusLabel:Set("Status: Active")
            bossStatus:Set("Bosses: " .. (config.farmBosses and "ON" or "OFF"))
            
            local anyEnemy = false
            for _, enabled in pairs(enemyEnabled) do
                if enabled then anyEnemy = true break end
            end
            enemyStatus:Set("Enemies: " .. (anyEnemy and "ON" or "OFF"))
            
            local anyFood = false
            for _, foodZone in ipairs(foodZones) do
                if foodZone.enabled then anyFood = true break end
            end
            foodStatus:Set("Food: " .. (anyFood and "ON" or "OFF"))
            
            eggStatus:Set("Eggs: " .. ((config.autoPlant or config.autoHatch) and "ON" or "OFF"))
            
            local anySac = sacrificeActive.queen or sacrificeActive.king or sacrificeActive.frozen or sacrificeActive.walrus or sacrificeActive.fennec or sacrificeActive.mystic
            sacrificeStatus:Set("Sacrifice: " .. (anySac and "ON" or "OFF"))
        else
            statusLabel:Set("Status: Stopped")
            bossStatus:Set("Bosses: OFF")
            enemyStatus:Set("Enemies: OFF")
            foodStatus:Set("Food: OFF")
            eggStatus:Set("Eggs: OFF")
            sacrificeStatus:Set("Sacrifice: OFF")
        end
    end
end)

mainTab:CreateSection("Credits")
mainTab:CreateLabel("developed by Maveryk1t")
mainTab:CreateLabel("yt: Maveryk1t")
mainTab:CreateLabel("discord: knzd1")

-- ABA INIMIGOS (dinâmica)
local enemiesTab = win:CreateTab("Enemies")
enemiesTab:CreateSection("Enemy Farming")
enemiesTab:CreateToggle({ Name = "Enable Enemies", CurrentValue = config.farmEnemies, Callback = function(v) config.farmEnemies = v end })

enemiesTab:CreateSection("Enemy List (auto-refresh)")
-- Será preenchido dinamicamente
local enemyToggles = {}
local function refreshEnemyList()
    -- Limpar toggles antigos
    for _, toggle in pairs(enemyToggles) do
        toggle:Remove()
    end
    enemyToggles = {}
    
    for i, enemy in ipairs(enemyList) do
        local toggle = enemiesTab:CreateToggle({
            Name = enemy.name .. " (" .. enemy.zone .. ")",
            CurrentValue = enemyEnabled[i] or false,
            Callback = function(v) enemyEnabled[i] = v end
        })
        enemyToggles[i] = toggle
    end
end
refreshEnemyList()
-- Atualizar quando a lista mudar
task.spawn(function()
    while true do
        task.wait(15)
        refreshEnemyList()
    end
end)

-- ABA COMIDA
local foodTab = win:CreateTab("Food")
foodTab:CreateSection("Food Zones")
foodTab:CreateToggle({ Name = "Enable Food", CurrentValue = config.farmFood, Callback = function(v) config.farmFood = v end })
foodTab:CreateToggle({ Name = "Crystal Food", CurrentValue = foodZones[1].enabled, Callback = function(v) foodZones[1].enabled = v end })
foodTab:CreateToggle({ Name = "Draco Food", CurrentValue = foodZones[2].enabled, Callback = function(v) foodZones[2].enabled = v end })

-- ABA BOSSES
local bossTab = win:CreateTab("Bosses")
bossTab:CreateSection("Boss Control")
bossTab:CreateToggle({ Name = "Enable Boss Farming", CurrentValue = config.farmBosses, Callback = function(v) config.farmBosses = v end })
bossTab:CreateToggle({ Name = "Enable All Bosses", CurrentValue = true, Callback = function(v)
    for _, name in ipairs(bossList) do bossEnabled[name] = v end
end })

bossTab:CreateSection("Boss List")
for _, name in ipairs(bossList) do
    bossTab:CreateToggle({
        Name = name,
        CurrentValue = bossEnabled[name],
        Callback = function(v) bossEnabled[name] = v end
    })
end

-- ABA OVOS
local eggTab = win:CreateTab("Eggs")
eggTab:CreateSection("Eggs Control")
eggTab:CreateToggle({ Name = "Auto Plant", CurrentValue = config.autoPlant, Callback = function(v) config.autoPlant = v end })
eggTab:CreateToggle({ Name = "Auto Hatch", CurrentValue = config.autoHatch, Callback = function(v) config.autoHatch = v end })
eggTab:CreateToggle({ Name = "Auto Nests", CurrentValue = config.autoNests, Callback = function(v) config.autoNests = v end })

eggTab:CreateSection("Speeds")
eggTab:CreateSlider({
    Name = "Plant Speed",
    Range = {0.001, 2},
    Increment = 0.001,
    CurrentValue = config.plantSpeed,
    Callback = function(v) config.plantSpeed = v end
})
eggTab:CreateSlider({
    Name = "Hatch Speed",
    Range = {0.001, 2},
    Increment = 0.001,
    CurrentValue = config.hatchSpeed,
    Callback = function(v) config.hatchSpeed = v end
})
eggTab:CreateSlider({
    Name = "Nests Speed",
    Range = {0.001, 2},
    Increment = 0.001,
    CurrentValue = config.nestsSpeed,
    Callback = function(v) config.nestsSpeed = v end
})

eggTab:CreateSection("Select Eggs")
for _, egg in ipairs(eggData) do
    eggTab:CreateToggle({
        Name = egg.name,
        CurrentValue = false,
        Callback = function(val)
            if val then
                if not table.find(eggsSelected, egg.zone) then
                    table.insert(eggsSelected, egg.zone)
                end
            else
                local idx = table.find(eggsSelected, egg.zone)
                if idx then table.remove(eggsSelected, idx) end
            end
        end
    })
end

eggTab:CreateButton({
    Name = "Remove Hatch Animation",
    Callback = function()
        local ev = ReplicatedStorage and ReplicatedStorage:FindFirstChild("Remotes") and ReplicatedStorage.Remotes:FindFirstChild("Events")
        if ev and ev:FindFirstChild("HatchAnimationEvent") then
            ev.HatchAnimationEvent:Destroy()
        end
    end
})

-- ABA SACRIFÍCIO
local sacrificeTab = win:CreateTab("Sacrifice")
sacrificeTab:CreateSection("Summer Event")
sacrificeTab:CreateToggle({
    Name = "Queen Bee (Mythical) - Loop",
    CurrentValue = sacrificeActive.queen,
    Callback = function(v)
        sacrificeActive.queen = v
        toggleSacrifice("Queen Bee", v)
    end
})
sacrificeTab:CreateButton({
    Name = "Sacrifice Queen Bee (Once)",
    Callback = function() sacrificePet("Queen Bee") end
})

sacrificeTab:CreateToggle({
    Name = "King Bee (Legendary) - Loop",
    CurrentValue = sacrificeActive.king,
    Callback = function(v)
        sacrificeActive.king = v
        toggleSacrifice("King Bee", v)
    end
})
sacrificeTab:CreateButton({
    Name = "Sacrifice King Bee (Once)",
    Callback = function() sacrificePet("King Bee") end
})

sacrificeTab:CreateSection("Winter Event")
sacrificeTab:CreateToggle({
    Name = "Frozen Werewolf (Mythical) - Loop",
    CurrentValue = sacrificeActive.frozen,
    Callback = function(v)
        sacrificeActive.frozen = v
        toggleSacrifice("Frozen Werewolf", v)
    end
})
sacrificeTab:CreateButton({
    Name = "Sacrifice Frozen Werewolf (Once)",
    Callback = function() sacrificePet("Frozen Werewolf") end
})

sacrificeTab:CreateToggle({
    Name = "Walrus (Legendary) - Loop",
    CurrentValue = sacrificeActive.walrus,
    Callback = function(v)
        sacrificeActive.walrus = v
        toggleSacrifice("Walrus", v)
    end
})
sacrificeTab:CreateButton({
    Name = "Sacrifice Walrus (Once)",
    Callback = function() sacrificePet("Walrus") end
})

sacrificeTab:CreateSection("Sphinx Event")
sacrificeTab:CreateToggle({
    Name = "Fennec Fox (Mythical) - Loop",
    CurrentValue = sacrificeActive.fennec,
    Callback = function(v)
        sacrificeActive.fennec = v
        toggleSacrifice("Fennec Fox", v)
    end
})
sacrificeTab:CreateButton({
    Name = "Sacrifice Fennec Fox (Once)",
    Callback = function() sacrificePet("Fennec Fox") end
})

sacrificeTab:CreateToggle({
    Name = "Mystic Camel (Legendary) - Loop",
    CurrentValue = sacrificeActive.mystic,
    Callback = function(v)
        sacrificeActive.mystic = v
        toggleSacrifice("Mystic Camel", v)
    end
})
sacrificeTab:CreateButton({
    Name = "Sacrifice Mystic Camel (Once)",
    Callback = function() sacrificePet("Mystic Camel") end
})

-- ABA MISC
local miscTab = win:CreateTab("Misc")
miscTab:CreateSection("Movement")
miscTab:CreateToggle({ Name = "Infinite Double Jump", CurrentValue = config.doubleJump, Callback = function(v)
    config.doubleJump = v
    if v then
        local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid:SetStateEnabled(Enum.HumanoidStateType.Jumping, true)
            jumpCount = 0
            if not jumpConnection then
                jumpConnection = humanoid.Jumping:Connect(function()
                    jumpCount = jumpCount + 1
                    if jumpCount >= 2 then
                        humanoid.Jump = true
                        jumpCount = 0
                    end
                end)
            end
        end
    elseif jumpConnection then
        jumpConnection:Disconnect()
        jumpConnection = nil
        jumpCount = 0
    end
end })

miscTab:CreateSlider({ Name = "Walk Speed", Range = {16, 100}, Increment = 1, CurrentValue = config.wallspeed, Callback = function(v)
    config.wallspeed = v
    local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
    if humanoid then
        humanoid.WalkSpeed = v
    end
end })

miscTab:CreateSection("Anti-AFK")
miscTab:CreateToggle({ Name = "Enable Anti-AFK", CurrentValue = config.antiAfk, Callback = function(v)
    config.antiAfk = v
    if v and active then
        startAntiAfk()
    elseif not v then
        stopAntiAfk()
    end
end })

miscTab:CreateSection("Hotkey")
miscTab:CreateLabel("Press H to hide/show GUI")

local guiVisible = true
UserInputService.InputBegan:Connect(function(input, gp)
    if not gp and input.KeyCode == Enum.KeyCode.H then
        guiVisible = not guiVisible
        for _, v in pairs(win:GetChildren()) do
            if v:IsA("ScreenGui") then
                v.Enabled = guiVisible
            end
        end
    end
end)

-- Notificação de carregamento
game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "Maveryk Hub",
    Text = "Loaded successfully! Ultra version",
    Duration = 3
})
